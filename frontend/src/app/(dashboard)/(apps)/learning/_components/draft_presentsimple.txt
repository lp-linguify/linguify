import React, { useState } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { CheckCircle2, XCircle } from 'lucide-react';

// Définition des règles de grammaire
const grammarRules = [
  {
    title: "Formation de base",
    explanation: "Pour la plupart des verbes, on ajoute simplement -s à la 3ème personne du singulier (il/elle/on).",
    examples: [
      { base: "play", thirdPerson: "plays" },
      { base: "work", thirdPerson: "works" },
      { base: "study", thirdPerson: "studies" }
    ]
  },
  {
    title: "Verbes se terminant par -ss, -sh, -ch, -x",
    explanation: "Pour ces verbes, on ajoute -es à la 3ème personne du singulier.",
    examples: [
      { base: "kiss", thirdPerson: "kisses" },
      { base: "wash", thirdPerson: "washes" },
      { base: "watch", thirdPerson: "watches" }
    ]
  },
  {
    title: "Verbes se terminant par -y",
    explanation: "Pour les verbes se terminant par une consonne + y, on change le y en i et on ajoute -es.",
    examples: [
      { base: "study", thirdPerson: "studies" },
      { base: "try", thirdPerson: "tries" },
      { base: "fly", thirdPerson: "flies" }
    ]
  }
];

// Exercice interactif
const InteractiveExercise = () => {
  const [exercises, setExercises] = useState([
    { base: "play", correct: "plays", userAnswer: "" },
    { base: "wash", correct: "washes", userAnswer: "" },
    { base: "study", correct: "studies", userAnswer: "" }
  ]);

  const handleAnswerChange = (index: number, value: string) => {
    const newExercises = [...exercises];
    newExercises[index].userAnswer = value;
    setExercises(newExercises);
  };

  const checkAnswer = (exercise: { base: string, correct: string, userAnswer: string }) => {
    return exercise.userAnswer.trim().toLowerCase() === exercise.correct;
  };

  return (
    <Card className="mt-6">
      <CardHeader>
        <CardTitle>Pratique : Transformez les verbes</CardTitle>
      </CardHeader>
      <CardContent>
        {exercises.map((exercise, index) => (
          <div key={index} className="mb-4 flex items-center space-x-4">
            <span className="font-medium w-20">{exercise.base}</span>
            <input
              type="text"
              value={exercise.userAnswer}
              onChange={(e) => handleAnswerChange(index, e.target.value)}
              placeholder="3ème personne du singulier"
              className="border p-2 rounded flex-grow"
            />
            {exercise.userAnswer && (
              checkAnswer(exercise) ? (
                <CheckCircle2 className="text-green-500" />
              ) : (
                <XCircle className="text-red-500" />
              )
            )}
          </div>
        ))}
      </CardContent>
    </Card>
  );
};

// Composant principal de la leçon de grammaire
export default function PresentSimpleGrammarLesson() {
  return (
    <div className="max-w-4xl mx-auto p-6">
      <h1 className="text-2xl font-bold mb-6">Le Présent Simple en Anglais</h1>
      
      <Card className="mb-6">
        <CardHeader>
          <CardTitle>Introduction</CardTitle>
        </CardHeader>
        <CardContent>
          <p>Le présent simple est utilisé pour :</p>
          <ul className="list-disc pl-6 space-y-2 mt-2">
            <li>Parler d'habitudes et de routines</li>
            <li>Exprimer des vérités générales</li>
            <li>Décrire des états permanents</li>
          </ul>
        </CardContent>
      </Card>

      {grammarRules.map((rule, index) => (
        <Card key={index} className="mb-6">
          <CardHeader>
            <CardTitle>{rule.title}</CardTitle>
          </CardHeader>
          <CardContent>
            <p className="mb-4">{rule.explanation}</p>
            <div className="grid grid-cols-2 gap-4">
              {rule.examples.map((example, exIndex) => (
                <div key={exIndex} className="bg-gray-100 p-3 rounded">
                  <div className="font-medium">Base : {example.base}</div>
                  <div className="text-blue-600">3ème personne : {example.thirdPerson}</div>
                </div>
              ))}
            </div>
          </CardContent>
        </Card>
      ))}

      <InteractiveExercise />

      <Card className="mt-6">
        <CardHeader>
          <CardTitle>Conseils supplémentaires</CardTitle>
        </CardHeader>
        <CardContent>
          <ul className="list-disc pl-6 space-y-2">
            <li>N'oubliez pas que le verbe BE (être) est irrégulier : is pour he/she/it</li>
            <li>Les verbes à la 3ème personne du singulier sont toujours à la forme simple</li>
            <li>Pratiquez régulièrement pour maîtriser ces règles</li>
          </ul>
        </CardContent>
      </Card>
    </div>
  );
}